language: c

os:
  - linux
  - osx

env:
  global:
    - RMGPY_REPO='https://github.com/ReactionMechanismGenerator/RMG-Py.git'
    - RMGDB_REPO='https://github.com/ReactionMechanismGenerator/RMG-database.git'
    - RMGPY_TAG='stable'
    - RMGDB_TAG='stable'

before_install:
  - cd ..
  # Install miniconda
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then wget http://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh -O miniconda.sh; fi
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then wget http://repo.continuum.io/miniconda/Miniconda2-latest-MacOSX-x86_64.sh -O miniconda.sh; fi
  - bash miniconda.sh -b -p $HOME/miniconda
  - export PATH=$HOME/miniconda/bin:$PATH
  - conda update --yes conda
  - conda info -a

install:
  # Clone RMG-Py
  - git clone -b $RMGPY_TAG $RMGPY_REPO
  # Clone RMG-database
  - git clone -b $RMGDB_TAG $RMGDB_REPO
  # Setup conda build
  - conda install -y conda-build
  - conda install -y anaconda-client
  - conda config --add channels rmg
  - conda config --set anaconda_upload yes

script:
  - conda build --token $CONDA_UPLOAD_TOKEN --user rmg RMG-database
  - conda build --token $CONDA_UPLOAD_TOKEN --user rmg RMG-Py

